2016-03-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2prog.cc (jtag2::eraseProgramMemory): bail out if
	running on debugWIRE
	* src/jtag3prog.cc (jtag3::eraseProgramMemory): (Dito.)

2016-03-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2rw.cc(jtag2::jtagWrite): omit chip erase when
	operating on debugWIRE
	* src/jtag3rw.cc(jtag3::jtagWrite): (Dito.)

2016-03-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag3.h: Mark jtag3::doSimpleJtagCommand() as throwing
	exceptions
	* src/jtag3rw.cc: (Dito.)

2016-03-02 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc (hid_thread): Support packet fragmentation and
	assembly (for mEDBG).

2016-03-01 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc: Determine max. transfer size from DAP_Info
	response

2016-02-29 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version date after merging jwunsch_edbg
	branch back into trunk

2016-02-29 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/main.cc: Improve explanation of -4 option, default EDBG to
	USB, and set debug output to line buffered mode
	* src/jtag2usb.cc: Fix packet size when passing event upstream

2016-02-26 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc: Implement libhidapi support for EDBG-based ICEs

2016-02-22 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Add hooks for libhidapi

2015-06-24 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Submitted by Uwe Frank <frank@drello.de>
	* src/devdescr.cc (ATxmega192A3): New entry
	* doc/avarice.1: Document the new entry.

2015-05-18 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Submitted by Tobias Frost <tobi@debian.org>:
	Bug #34 Fix compilation with GCC 5
	* src/pragma.h: Fix pragmas for GCC > 4

2014-12-10 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version date.

2014-10-13 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/remote.cc (monitor): implement a "mon reset" command.

2014-09-19 Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* tools/edbg.lua: New file.

2013-06-29 Joerg Wunsch <joerg.wunsch@atmel.com>

	* src/jtag3bp.cc (jtag3::updateBreakpoints): don't accidentally
	truncate code breakpoints to 64 KiB

2013-04-24 Joerg Wunsch <joerg.wunsch@atmel.com>

	* src/jtag2rw.cc (jtagRead, jtagWrite): Handle Xmega page sizes of
	more than 256 bytes which need to be split into multiple transfers
	on the JTAGICEmkII.

2013-04-16 Joerg Wunsch <joerg.wunsch@atmel.com>

	* src/remote.cc (talkToGdb): When returning a memory map to GDB,
	treat the possible EEPROM range just like normal RAM, so GDB
	won't refuse to load it.

2013-03-19 Joerg Wunsch <joerg.wunsch@atmel.com>

	* src/devdescr.cc (ATmega256RFR2, ATmega2564RFR2, ATmega128RFR2,
	ATmega1284RFR2, ATmega64RFR2, ATmega644RFR2):
	New devices
	* src/ioreg.cc (atmega256rfr2_io_registers): New entry, used for
	all of the ATmega*RFR2 devices.
	* src/ioreg.h: (Dito.)

2013-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc: Turn the write operation of the packet length
	and the packet itself into an atomic one when writing to the
	upstream pipe, in order to avoid a race condition when handling
	JTAGICE3 event messages.

2013-01-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag3run.cc (jtag3::getProgramCounter): Add some ugly hack
	to work around problems single-stepping a SLEEP instruction
	* src/jtag3rw.cc (jtag3::jtagRead): (Dito.)

2013-01-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag3io.cc (jtag3::setDeviceDescriptor): avoid an overly
	aggressive compiler optimization on a parameter struct d3

2013-01-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2rw.cc (jtag2::jtagRead): delete response before throwing
	out
	* src/jtag3rw.cc (jtag3::jtagRead): (Dito.)

2013-01-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtagrw.cc (jtag1::jtagRead): When attempting to read more than
	256 bytes, throw an exception rather than returning a nonsensical
	value.
	* src/jtag3io.cc (jtag3::startJtagLink): Fix an off-by-one error
	when preparing the AVR sign-on command.
	* src/jtag2usb.cc (opendev): fix devnamecopy deletion.

2013-01-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag3io.cc (initJtagOnChipDebugging): reenable CMD3_START_DEBUG
	for Xmega (even over JTAG)

2013-01-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Document the JTAGICE3 support.
	* src/main.cc (usage): (Dito.)

2013-01-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/main.cc (makeSocket): Be a little more verbose if bind()
	failed with EADDRINUSE.

2013-01-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtaggeneric.cc: Remove enableProgramming()/disableProgramming()
	calls in fuse handling; the respective backend jtagRead()/jtagWrite()
	functions are in charge of deciding whether they need a programming
	mode or not
	* src/jtag3io.cc: fix device ID recognition when operating on
	debugWIRE targets; activate the #ifdef'ed out jtagActivateOcdenFuse
	call; only call CMD3_START_DEBUG for debugWIRE; at the end of
	initialization, attempt resetProgram() a second time if the first
	time failed (appears to be needed after just activating the OCDEN
	fuse)

2013-01-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag3rw.cc(jtag3::jtagWrite): fix off-by-one error that lead
	to writing wrong data
	* src/remote.cc: Implement GDB 7+ flash write protocol

2013-01-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/remote.cc: Implement the "monitor" GDB command.

2013-01-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h (struct breakpoint2): Introduce the has_mask flag.
	* src/jtaggeneric.cc: Fix the logic to commit data mask breakpoints
	to the ICE.

2013-01-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc: Centralize addBreakpoint(), deleteBreakpoint(),
	and layoutBreakpoints() as they are common between the JTAGICE mkII
	and JTAGICE3.
	* src/jtag2.h: (Dito.)
	* src/jtag3.h: (Dito.)
	* src/jtag.h: (Dito.)
	* src/jtag2bp.cc: (Dito.)
	* src/jtag3io.cc: (Dito.)
	* src/jtaggeneric.cc: (Dito.)
	* src/jtag3bp.cc: (Dito.)

2013-01-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* jtag.h: Remove codeBreakpointBetween() and stopAt() methods
	* jtag1.h: (Dito.)
	* jtag2.h: (Dito.)
	* jtag3.h: (Dito.)
	* jtagbp.cc: (Dito.)
	* jtagio.cc: (Dito.)
	* jtag2bp.cc: (Dito.)
	* jtag2io.cc: (Dito.)
	* jtag3bp.cc: (Dito.)
	* jtag3io.cc: (Dito.)

2013-01-04  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac (AC_INIT): Bump version.

2013-01-04  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Bring in the initial JTAGICE3 support.  Not quite everything is
	working, but it's good enough for a start.
	* src/jtag.h: Add parameter structure for ICE3.
	* src/jtag2.h: Move enum debugproto and class jtag_io_exception
	out into jtag.h as the ICE3 also uses them.
	* src/main.cc: Add the -3/--jtag3 option, and handle jtag3 object
	instanciation
	* src/devdescr.cc: Add osccal and ocdrev fields to each record.
	* src/jtaggeneric.cc: extend default contructor.
	* src/Makefile.am: Add new files to infrastructure.
	* configure.ac: Swap check for pthread and C++ compiler, so the
	CXXFLAGS get set correctly (-g -O2).
	* src/jtag3prog.cc: New file.
	* src/jtag3.h: (Dito.)
	* src/jtag3misc.cc: (Dito.)
	* src/jtag3run.cc: (Dito.)
	* src/jtag3io.cc: (Dito.)
	* src/jtag2usb.cc: (Dito.)
	* src/jtag3rw.cc: (Dito.)
	* src/jtag3bp.cc: (Dito.)
	* tools/pdml.xsl: Add timestamp to output.

2013-01-01  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtagrw.cc (jtag1::jtagRead): throw a jtag_exception
	rather than returning a NULL pointer if the ICE's response
	is not JTAG_R_OK.

2012-12-27  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Add hooks to detect libusb20 API (on FreeBSD)
	* src/jtag2usb.cc: Use libusb20 API if present; the libusb-0.1
	emulation that sits on top of it in FreeBSD 8+ doesn't allow for
	the kind of multithreading used here.

2012-12-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Submitted by Martin Cerveny:
	Bug #15 usblib timeouts does not work correctly on solaris platforms
	* src/jtag2usb.cc: Rewrite the USB daemon into Posix threads.
	* src/jtag2io.cc: (Dito.)
	* src/jtag.h: (Dito.)
	* src/jtag2run.cc: (Dito.)
	* src/jtaggeneric.cc: (Dito.)
	* m4_ax_pthread.m4: New file (pthread glue)
	* configure.ac: Include pthread detection.

2012-12-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2_io_exception::jtag2_io_exception):
	Fix a typo.

2012-12-06  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc (usb_daemon): Restructure the receiver
	logic so it no longer depends on the JTAGICEmkII message
	length indication.

2012-11-20  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* tools/ocdrev.xsl: Extract OCD_REVISION out of Atmel Studio
	6.x XML device files

2012-11-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* tools/pdml.xsl: New XSLT stylesheet to analyze Wireshark
	USB traces exported as PDML data

2012-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for post-release 2.13

2012-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for release 2.13

2012-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Contributed by Martin Cerveny (patch #3495107):
	Add IO register info for a large number of mega and tiny AVRs
	* src/devdescr.cc: add pointers to IO register definitions
	* src/ioreg.h: add declarations for the IO register definitions,
	extend "reg_addr" to "unsigned int" to accomodate space for the
	IO registers in newer AVRs
	* src/ioreg.cc: add new IO register definitions

2012-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Contributed by Chris Thunes (patch #3497114):
	* src/jtag2prog.cc (jtag2::eraseProgramMemory): Use
	CMND_XMEGA_ERASE to erase Xmega program memory
	* src/jtag_defs.h: add CMND_XMEGA_ERASE
	* src/jtag.h: (Dito)

2012-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Contributed by Chris Thunes (patch #3497114):
	* src/jtag2rw.cc (jtag2::memorySpace): Return the correct
	memory type for Xmega write operations.

2012-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Contributed by Mihai Hagianu (patch #3496094): add ATxmega128A3
	Contributed by Chris Thunes (patch #3497114): add ATxmega32A4
	* src/devdescr.cc (ATxmega32A4, ATxmega128A3): new entries
	* doc/avarice.1: Document new devices.

2012-11-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: In AC_LINK_IFELSE, use AC_LANG_SOURCE for the
	source code to be compiled, in order to silence a warning.
	Bump version to svn20121102.

2012-11-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Deprecate target ELF file programming (downloading).
	* configure.ac: Implement the --enable-target-programming
	configuration option; disabled by default.  No longer require
	the presence and usability of libbfd if not configured for
	the target programming feature.
	* src/main.cc: Disable --file, --program, and --verify
	unless ENABLE_TARGET_PROGRAMMING is in effect.
	* src/jtag2prog.cc: Turn the downloadTarget method into a
	dummy unless ENABLE_TARGET_PROGRAMMING is in effect; remove
	all dependencies from bfd.h / libbfd otherwise.
	* src/jtagprog.cc: (Dito.)
	* doc/avarice.1: Document that --file, --program, and --verify
	are deprecated, and no longer enabled by default

2012-11-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* tools/devdescr.xsl: update for recent changes of src/jtag.h:
	generate fuses, and an empty Xmega device descriptor

2012-11-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Added megaM1 and megaC1 device: ATmega16M1,
	ATmega64M1, ATmega64C1
	* doc/avarice.1: Document new devices.

2012-07-31  Canyon Bliss  <canyon@recursivebliss.com>

	* doc/avarice.1: Updated list of devices.
	* src/devdescr.cc: Added xmegaB devices: ATxmega128B1, ATxmega128B3, 
	ATxmega64B1, ATxmega64B3.

2012-01-18  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Add a test whether libbfd requires libdl; fix
	the broken (always positive) test for libz as well.

2011-12-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Drop the remark that software breakpoints were
	currently not supported: they are.

2011-12-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Update list of devices.

2011-12-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2.h: Keep track of whether starting a debugging session
	with the ICE actually succeeded, and only ever attempt to send a
	CMND_RESTORE_TARGET in that case.  Sending it without a debugWIRE
	session succeeded (e.g. since the DWEN fuse wasn't active) might
	screw up the ICE's firmware.
	* src/jtag2io.cc: (Dito.)

2011-12-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	(Merging branch /branches/jwunsch_except/avarice)
	* src/jtag.h: Remove the restoreTarget parameter from the
	resumeProgram() method again; target restoration upon GDB
	disconnect is now being handled properly by catching the exception
	thrown in that case, through the destruction of theJtagICE object.
	* src/jtag1.h: (Dito.)
	* src/jtag2.h: (Dito.)
	* src/remote.cc: (Dito.)
	* src/jtag2io.cc: (Dito.)
	* src/jtag2run.cc: (Dito.)
	* src/jtagrun.cc: (Dito.)

2011-12-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	(Merging branch /branches/jwunsch_except/avarice)
	* src/remote.cc: Rearrange the entire error handling to use
	exceptions, rather than a mix between error code returns, and
	prematurely exiting the program from deep inside, without any
	attempt to cleanup the JTAG ICE connection status.  Get rid of all
	those scary check(), unixCheck() and jtagCheck() functions, catch
	exceptions where it makes sense.
	* src/remote.h: (Dito.)
	* src/jtag2io.cc: (Dito.)
	* src/jtagmisc.cc: (Dito.)
	* src/jtag1.h: (Dito.)
	* src/jtag2.h: (Dito.)
	* src/avarice.h: (Dito.)
	* src/jtagio.cc: (Dito.)
	* src/jtag2rw.cc: (Dito.)
	* src/main.cc: (Dito.)
	* src/jtag.h: (Dito.)
	* src/jtag2bp.cc: (Dito.)
	* src/jtag2run.cc: (Dito.)
	* src/jtagrw.cc: (Dito.)
	* src/jtag2prog.cc: (Dito.)
	* src/utils.cc: (Dito.)
	* src/jtagbp.cc: (Dito.)
	* src/jtagrun.cc: (Dito.)
	* src/jtagprog.cc: (Dito.)
	* src/jtag2usb.cc: (Dito.)
	* src/jtaggeneric.cc: (Dito.)
	* src/jtag2misc.cc: (Dito.)

2011-12-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for post-release.

2011-12-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for release 2.12.

2011-12-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc (atxmega16d4): new entry

2011-12-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2::startJtagLink): external reset is
	only applicable to the JTAG protocol

2011-12-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2::initJtagOnChipDebugging): ensure the
	device went once through a programming-mode cycle, as at least
	firmware 7.13 otherwise gets royally confused on Xmega devices.

2011-12-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2::startJtagLink): set the signedIn flag
	as soon as we succeeded with synchronizeAt() (which has sent
	the sign-on message), so we properly say good-bye afterwards

2011-12-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2run.cc (jtag2::resetProgram): Fix a logic error
	introduced in r259.

2011-12-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc (opendev): Don't attempt to free(serno); it's
	the result of strchr() rather than any kind of memory allocation
	operation.

2011-12-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Get rid of bogus fuse definition enum values
	(would only match on some devices anyway); bump
	MAX_FLASH_PAGE_SIZE and MAX_EEPROM_PAGE_SIZE for Xmega (though
	that's currently not really usable).
2011-12-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Get rid of the global variable global_p_device_def,
	replacing it by public member deviceDef
	* src/remote.cc: (Dito.)
	* src/jtag2io.cc: (Dito.)
	* src/jtagio.cc: (Dito.)
	* src/jtag2rw.cc: (Dito.)
	* src/jtag2bp.cc: (Dito.)
	* src/devdescr.cc: (Dito.)
	* src/jtaggeneric.cc: (Dito.)

2011-12-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Major overhaul of the fuse handling.
	* src/jtag.h: add device config parameters `fusemap' and
	`ocden_fuse'; add method jtagActivateOcdenFuse() to centralize the
	OCDEN fuse activation
	* src/devdescr.cc: add fusemap and ocden_fuse values
	* src/jtaggeneric.cc: implement jtagActivateOcdenFuse(), restrict
	jtagWriteFuses() to non-Xmega devices, make jtagDisplayFuses()
	display Xmega fuses correctly
	* src/jtagio.cc (initJtagOnChipDebugging): resort OCDEN activation
	to jtagActivateOcdenFuse()
	* src/jtag2io.cc (initJtagOnChipDebugging): (Dito.)

2011-12-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Implement PDI debugging for the JTAGICEmkII (and AVR Dragon) and
	Xmega devices.  This is basically the same as JTAG, except for the
	different ICE initialization.
	* src/jtag.h: add EMULATOR_MODE_PDI
	* src/jtag2.h: add an enum debugproto
	* src/jtag2io.cc: handle the `proto' field
	* src/jtag2rw.cc: (Dito.)
	* src/jtag2bp.cc: (Dito.)
	* src/jtag2run.cc: (Dito.)
	* src/jtag2prog.cc: (Dito.)
	* src/devdescr.cc (atxmega128a1_revd): fix is_xmega field
	* src/main.cc: implement new -X (--pdi) option
	* doc/avarice.1: document the new option

2011-12-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version to 2.12.rc1.

2011-12-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc (dummyhandler): Put into #if defined(O_ASYNC),
	because it is only used in that case.

2011-12-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h (statusAreaAddress, cpuRegisterAreaAddress): put
	the "const" qualifier into the correct place
	* src/jtag1.h: (Dito.)
	* src/jtag2.h: (Dito.)

2011-12-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2.h (BREAKPOINT2_XMEGA_UNAVAIL): new constant
	* src/jtag2bp.cc: Use BREAKPOINT2_XMEGA_UNAVAIL, rather than using
	a magic number; fill in BP info for CMND_SET_BREAK even though AVR
	Studio doesn't appear to use it (but it's consistent with the
	non-Xmega code that way)

2011-12-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h (enum bpType): Drop the HAS_MASK flag value, also
	remove the unused SOFTCODE value.
	* src/jtag2bp.cc: Remove all occurences of HAS_MASK; data
	breakpoints (aka. watchpoints) do always have a mask associated
	once they have been instantiated, so there's no need to extra flag
	this.  The flagging completely violated the purpose of an enum
	type (abusing it as an `int'), causing missed BP type matches in
	some situations (e.g. when deleting a watchpoint).  Also mask off
	the internal flag bits (0x800000) from a data breakpoint before
	sending it to the ICE, rather than trying to send the internal
	address to the ICE.  Sending the full internal address to the ICE
	has been a mistake straight from the beginning even though it
	apparently used to work, but recent firmware versions appear to
	fully store the 24-bit address, causing the data breakpoint to
	never match.

2011-12-01  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: In jtag::resumeProgram(), add a new optional
	parameter "restoreTarget" to allow for a more graceful
	shutdown.
	* src/jtag1.h: (Dito.)
	* src/jtag2.h: (Dito.)
	* src/jtag2run.cc: (Dito.)
	* src/jtagrun.cc: (Dito.)
	* src/remote.cc: Gracefully shut down when GDB disconnects.

2011-12-01  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc (attiny4313): New entry.

2011-11-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtagio.cc (jtag1::initJtagOnChipDebugging): Drop the
	attempt to clear the lock bits; it's useless anyway, as the
	lockbits can only be cleared by a chip erase.
	* src/jtag2io.cc (jtag2::initJtagOnChipDebugging): (Dito.)

2011-11-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc (atxmega256a3): New entry.

2011-11-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h (xmega_device_desc_type): eeprom_page_size is
	only one byte
	* src/devdescr.cc (atxmega128a1, atxmega128a1revd): (Dito.)

2011-11-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2.h: Introduce jtag2:xmegaSendBPs().
	* src/jtag2bp.cc: Move out the CMND_SET_BREAK_XMEGA into
	jtag2:xmegaSendBPs(), as this needs to be issued in front
	of any single-step or run command.
	* src/jtag2run.cc: Call jtag2:xmegaSendBPs() where
	necessary.

2011-11-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Contributed by Detlev Kraft:
	* doc/avr-studio-5-detlev-kraft.pdf: New file, added with
	Detlev's kind permission.  (Sorry, German language only.)

2011-11-25  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2.h: Implement a "cached PC" to avoid re-requesting
	the PC value from the ICE over and over again.
	* src/jtag2run.cc: Cache the PC value obtained from the ICE.
	For actions that are expecting a BREAK event, catch the
	expected event immediately, and use the PC value obtained
	from that event.  Fork out jtag2::expectEvent() into a method
	of its own to centralize the code for it (this logic used to
	live inside jtag2::eventLoop() before).

2011-11-25  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2::doJtagCommand): Slightly improve the
	change from rev 240: don't attempt to retry definitively
	rejected commands; do not attempt to perform USB endpoint
	resets when the communication went fine but the result was
	not the expected one.

2011-11-24  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Add definition for MTYPE_XMEGA_APP_FLASH (thanks
	to Detlev's findings, again)
	* src/jtag2rw.cc: Implement MTYPE_XMEGA_APP_FLASH access, and
	fix MTYPE_XMEGA_REG access (must not enable programming mode).

2011-11-24  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Based on Detlev Kraft's guesses (many thanks to him again!),
	implement the new Xmega device descriptor setting for V7+
	firmware.
	* src/jtag.h: define xmega_device_desc_type
	* src/devdescr.cc: implement xmega_device_desc_type for
	ATxmega128A1(+revD)
	* src/jtag2io.cc: providing the firmware supports it, use
	xmega_device_desc_type rather than jtag2_device_desc_type when
	talking to an Xmega device

2011-11-23  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Attempt to implement some basic Xmega support for firmware
	revisions 7.x and above, i.e. AVR Studio 5 firmware.  Many thanks
	to Detlev Kraft for providing me with the details from his
	reengineering effort!
	* src/jtag.h: Add two new undocumented commands for Xmegas.
	* src/jtag2.h: Add the has_full_xmega_support feature flag.
	* src/jtag2io.cc: Determine whether the firmware is recent enough
	for has_full_xmega_support (>= 7.x).
	* src/jtag2bp.cc: Use CMND_SET_BREAK_XMEGA for the first two
	Xmega breakpoints, and software BPs for the rest.

2011-11-21  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Add REGISTER_SPACE_ADDR_OFFSET and the corresponding
	MTYPE_XMEGA_REG; add statusAreaAddress and cpuRegisterAreaAddress
	methods to cope with Xmega vs. megaAVR differences.
	* src/jtag1.h: Implement statusAreaAddress and
	cpuRegisterAreaAddress methods, respectively.
	* src/jtag2.h: (Ditto.)
	* src/remote.cc: Replace magic constants by calls to the
	statusAreaAddress and cpuRegisterAreaAddress methods,
	respectively.

2011-11-21  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2::doJtagCommand): Be more liberal in
	retrying failed commands (memory and PC read).
	* src/jtag2rw.cc (jtag2::jtagRead): (Ditto.)
	* src/jtag2run.cc (jtag2::getProgramCounter): (Ditto.)

2011-11-21  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Moved from CVS to SVN on sourceforge.net.

2011-08-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Feature Requests #3289022: Allow for the same device designations
	as avrdude
	* doc/avrdude.1 (-P): Document that AVaRICE normally autodetects
	the target device, and -P acts as an override only.

2011-08-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for post-release 2.11.

2011-08-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for release 2.11.

2011-08-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Patch #2842235: Fix segfault when programming with .fuses section
	* src/jtagprog.cc (get_section_addr): Return 0xffffffff for unknown
	section memory types, so sections like .fuses will be silently
	ignored.
	* src/jtag2prog.cc (get_section_addr): (Ditto.)

2011-08-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Submitted by Andrew Zabolotny:
	Patch #2995091: Fix gcc 4.4.1 warnings
	Actually, I went a lot further, and made it completely -Wall -Wextra
	clean for GCC 4.x.  (GCC 3.x users might want to use --disable-warnings
	in configure.)
	* configure.ac: Add --enable-warnings option.
	* src/pragma.h: New file, #pragma abstraction
	* src/jtag.h: Include "pragma.h" so it's universally usable
	* src/Makefile.am (avarice_SOURCES): Add pragma.h.
	* src/devdescr.cc: Silence compiler warnings.
	* src/gnu_getopt.c: (Ditto.)
	* src/jtag2.h: (Ditto.)
	* src/jtag2bp.cc: (Ditto.)
	* src/jtag2io.cc: (Ditto.)
	* src/jtag2prog.cc: (Ditto.)
	* src/jtag2run.cc: (Ditto.)
	* src/jtag2usb.cc: (Ditto.)
	* src/jtagbp.cc: (Ditto.)
	* src/jtaggeneric.cc: (Ditto.)
	* src/jtagio.cc: (Ditto.)
	* src/jtagprog.cc: (Ditto.)
	* src/jtagrw.cc: (Ditto.)
	* src/main.cc: (Ditto.)
	* src/remote.cc: (Ditto.)

2011-08-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Patch #2842239: Fix for deprecated string warning
	* src/jtag2prog.cc (jtag2::downloadToTarget): Turn "target" and
	"default_target" const to eliminate a compiler warning.

2011-05-06  Eric B. Weddington  <eric.weddington@atmel.com>

	Patch #3298045.
	* devdescr.cc: Fix device IDs for ATmega325P and ATmega3250P.

2009-08-26  Shaun Jackman  <sjackman@gmail.com>

	* configure.ac: add bfd_object() to the check whether libbfd
	requires libz.

2009-06-25  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	bug 2812023: build failed with gcc 4.4.0
	* src/jtag2usb.cc (opendev): make a local copy of jtagDeviceName,
	and then operate on that copy instead of trying to modify a const
	object.

2009-05-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc (ATmega128RFA1): update the number of
	interrupt vectors, and extended IO bitmaps.

2009-05-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* tools/devdescr.xsl: update for rev 1.29 of src/jtag.h:
	generate the is_xmega flag correctly

2009-04-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for post-release 2.10.

2009-04-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for release 2.10.

2009-04-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Check whether libbfd requires libz (true for
	libbfd 2.19 and above); while here, replace the obosolete
	AC_TRY_COMPILE by AC_COMPILE_IFELSE.

2009-03-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for post-release 2.9.

2009-03-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version for release 2.9.

2009-02-24  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc (atmega128rfa1): new device.

2008-10-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2run.cc (jtag2::jtagSingleStep): When being interrupted by
	GDB while waiting for the EVT_BREAK from a CMND_SINGLE_STEP, we must
	issue a CMND_STOP_PROGRAM before proceeding.

2008-09-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: More ATxmega support.  As the Xmega requires a
	different initialization, this must be made known to AVaRICE
	beforehand.  The option -x (--xmega) can be used to tell AVaRICE
	that the target is an Xmega.  Alternatively, specifying an
	ATxmega device explicitly through -P will also work.
	* src/jtag2.h: (Ditto.)
	* src/jtag2io.cc: (Ditto.)
	* src/main.cc: (Ditto.)
	* src/devdescr.cc: (Ditto.) Additionally, provide a separate
	entry for the ATxmega128A1 rev D as this device uses a different
	JTAG ID.
	* doc/avarice.1: Document the -x/--xmega option.

2008-09-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version to post-2.8.

2008-09-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version to 2.8.

2008-08-26  Nils Kristian Strom  <nilsst@invalid.ed.ntnu.no>

	* src/main.cc (usage): Add -R/--reset-srst to usage.

2008-07-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtagprog.cc: Fix "deprecated conversion from string
	constant to char *" warnings.
	* src/main.cc: (Ditto.)

2008-06-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version date.

2008-06-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Implement external reset through nSRST signal.
	Based on the idea from patch #1398862 but implemented
	in a completely different way.
	* src/jtag.h: Add apply_nSRST to struct jtag, and parameter
	possible_nSRST to resetProgram().
	* src/jtag1.h: Add nrst to constructor.
	* src/jtag2.h: (Ditto.)
	* src/jtag2io.cc: Try applying nSRST before enabling JTAG
	emulation.
	* src/jtag2run.cc: possible_nSRST is ignored in mkII
	resetProgram().
	* src/jtagio.cc: Add possible_nSRST parameters.
	* src/remote.cc: (Ditto.)
	* src/jtagrun.cc: Implement possible_nSRST for mkI.
	* src/main.cc: Add option -R/--reset-srst.
	* doc/avarice.1: Document option -R/--reset-srst.

2008-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/main.cc: Add "target_sleep" to the list of events to be
	ignored by default.
	* doc/avarice.1: Document the above change.

2008-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Document all the newly supported devices.
	* src/devdescr.cc: Remove duplicate entry for AT90USB1287;
	fix EECRAddress for all recent entries (must be fill_b2()).
	* tools/devdescr.xsl: Add fill_b2() to EECRAddress.

2008-05-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1948200 ] Add option to print list of known devices
	Submitted by  Rick Mann
	* src/main.cc: Add the option -k/--known-devices.
	Sort deviceDefinitions alphabetically before.
	* doc/avarice.1: Document the -k option.

2008-05-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ patch 1909351 ] ATmega32c1, ATmega32m1
	[ patch 1909933 ] sync to xml from avrstudio 4.14 beta
	Submitted by David B. Curtis
	* src/devdescr.cc: Add support for all currently known (by
	AVR Studio's partdescription files) AVR devices.

2008-05-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ patch 1750202 ] set parameter command failed
	(Original patch *not* used though.)
	* src/jtag2run.cc (jtag2::resetProgram, jtag2::eventLoop):
	After issuing a JTAG reset, wait for the ICE to post the
	respective BREAK event.  Since resetProgram() can be
	called fairly early before the GDB communication has been
	set up, make eventLoop() aware of gdbFileDescriptor
	possibly being still at -1, so it ought to be ignored.

2008-05-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ patch 1587395 ] decrease default bitrate
	Submitted by  Stas Sergeev
	* src/main.cc (usage, main): Default JTAG bitrate to
	250 kHz rather than 1 MHz, change usage message for
	that.
	* doc/avarice.1: Document the changed default JTAG bitrate.

2008-05-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1865183 ] bfd.h not used for checking of libbfd
	* configure.ac: Don't just check for bfd.h but complain
	at configure time if it has not been found.

2008-05-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1880464 ] AVR-Dragon needs libusb-dev
	* src/jtaggeneric.cc (jtag::jtag): throw an error message
	and bail out when called with "-j usb" but not configured
	for libusb support.

2008-05-25  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version.

2008-05-25  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1833340 ] cannot read program counter/Watchdog has expired
	* src/jtag2run.cc (jtag2::eventLoop): Carefully handle all the
	different events that could be posted by the ICE, as opposed to
	just assuming every event would work like a BREAK where
	AVaRICE is then allowed to go ahead, and fetch the program
	counter value.

2008-02-25  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Add entries for ATtiny84 and ATtiny85.

2008-01-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1831392 ] --jtag option does not default to usb using dragon
	* src/main.cc: Fix logic for defaulting jtagDeviceName so the
	environment variable JTAG_DEV will be honoured, yet the AVR Dragon
	will still default to USB rather than /dev/avrjtag.

2008-01-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1833342 ] useless warning message about jtag bitrate using dragon
	* src/main.cc: Restrict the warning about defaulting the JTAG bit
	rate to JTAG protocols only.

2008-01-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	[ 1869060 ] jtag daisy chain bits limitations
	* src/main.cc: Apply the correct limitations for JTAG
	daisy-chaining.

2008-01-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/main.cc: Issue a warning when trying to chip erase in
	debugWire mode.
	* doc/avarice.1: Document that chip erase is not supported in
	debugWire mode.

2008-01-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc (jtag2::recvFrame): make msglen and its related
	variables unsigned int so they cannot suddenly become negative.

2007-11-13  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2bp.c (jtag2::addBreakpoint): fix a comparison that
	turned out to be an assignment.

2007-11-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Fix a bug with single-stepping on the JTAG ICE mkII or AVR Dragon.
	Single-stepping essentially behaves identical to CMND_GO, i. e. it
	returns immediately but the caller gets an EVT_BREAK posted once
	the single-step is completed.  In particular for software
	breakpoints (like on debugWire), this could take a bit more time
	than the internal processing delay.  When AVaRICE continued, and
	tried to query the program counter, the ICE wasn't ready yet
	again, and everything fell into parts.
	* src/jtag2.h: add new eventLoop() method.
	* src/jtag2run.cc: move the heart of jtag2::jtagContinue() out
	into eventLoop(), and use this method similarly for the
	jtag2::jtagSingleStep() method to await the EVT_BREAK.

2007-11-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to post-2.7

2007-10-30  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to 2.7

2007-07-08  Shaun Jackman  <sjackman@gmail.com>

	* src/jtag2bp.cc (layoutBreakpoints) <useDebugWire>: Bug fix.
	GDB continue command would hang when using debugWire.
	* src/jtag2io.cc (recvFrame): Correctly report a timeout.
	* src/jtag2run.cc (resetProgram): The JTAG ICE mkII and Dragon
	do not respond correctly to the CMND_RESET command while in
	debugWire mode. Send CMND_FORCED_STOP and CMND_WRITE_PC(0)
	instead.

2007-08-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version date.

2007-08-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Implement user-configurable ICE event handling for
	the JTAG ICE mkII.
	* src/jtag1.h: (Ditto.)
	* src/jtag2.h: (Ditto.)
	* src/jtag2run.cc: (Ditto.)
	* src/jtagrun.cc: (Ditto.)
	* src/main.cc: (Ditto.)
	* doc/avarice.1: Document the new option.

2007-08-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtaggeneric.cc: properly initialize private class members
	of jtag objects in all constructors, not just the default one
	(which we actually don't use).

2007-07-23  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* INSTALL-FROM-CVS: Bump required version numbers for automake to
	1.9, and autoconf to 2.59 as this is the only thing we are testing
	these days.

2007-04-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Submitted by Dave N6NZ
	* src/devdescr.cc: add entries for ATmega325/3250/645/6450.

2007-03-21 Colin O'Flynn <coflynn@newae.com>

	* src/main.cc: Added patch #1121113 which adds a JTAG_DEV env variable
	* doc/avarice.1: Added JTAG_DEV to docs

2007-02-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Add entries for AT90PWM2/3B.
	* tools/devdescr.xsl: Declare the "count" parameter in the format-hex
	template.  Recent versions of xsltproc appear to be more picky about
	that.

2007-02-22  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump date, now that we've got a first previous of
	Colin's soft BP implementation.

2007-02-20  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	(On behalf of Colin O'Flynn)
	* src/jtag2bp.cc: Implement software breakpoints.
	* src/jtag2.h: (Ditto.)

2007-02-17  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump date.

2007-02-17  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc: Complete overhaul of the USB communication:
	- Use a second pipe (ctrlPipe) between main AVaRICE and the
	  daemon to signal control information.
	- Move the entire libusb handling from the parent into the
	  child process, so it only happens a single time.  Have the
	  parent wait until the child could make a decision, either
	  failure to find the requested USB device, or success of being
	  able to talk to it.
	- Do no longer poll USB when not needed, instead either read a
	  reply when the master process told the daemon it is expecting
	  one, or start polling while the target is running.
	- Add an option for the parent to have the USB daemon clear the
	  endpoints after seeing successive timeouts while data was
	  expected.
	- Examine the header of received data, and if the block length
	  indicates more data will be folllowing the first read, go
	  ahead and fetch them immediately.
	* src/jtag.h: Add ctrlPipe.
	* src/jtag2io.cc: Use ctrlPipe if present.
	* src/jtag2run.cc: (Ditto.)
	* src/jtaggeneric.cc: Initialize ctrlPipe in constructor.

2006-12-22  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to post-2.6
	* NEWS: add boilerplate for next release

2006-12-21  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to 2.6

2006-11-14  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc: Try to set the O_ASYNC flag only if the
	host operating system does actually support it.

2006-11-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Replace the ATmega164 and ATmega324 device
	descriptors by ATmega164P and ATmega324P ones, as the former
	devices have never been released.
	* doc/avarice.1: Document that change.

2006-11-05  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2usb.cc: Rearrange the procedure to open an USB device
	so that the usb_dev_handle is not going to be inherited across a
	fork().  Doing so did cause problems on the OSX implementation of
	libusb.

2006-10-28  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Document the AVR Dragon support.  Also add
	all the debugWire-supported AVRs.

2006-10-28  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Make a first stab of an implementation for the AVR
	Dragon.  This is mostly the same as the JTAG ICE mkII, except it
	can only talk USB and has a different USB product ID.
	Documentation not yet done.
	* src/jtag2.h: (Ditto.)
	* src/jtag2io.cc: (Ditto.)
	* src/jtag2usb.cc: (Ditto.)
	* src/jtaggeneric.cc: (Ditto.)
	* src/main.cc: (Ditto.)

2006-10-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to post-2.5
	* NEWS: add boilerplate for next r

2006-10-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to 2.5

2006-10-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2io.cc: Don't mess with the fuse or lock bits in
	debugWire mode.
	* src/main.cc: Add --erase to the example usage.
	* NEWS: (New file.)
	* Makefile.am (EXTRA_DIST): Add NEWS.

2006-09-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Implement basic soft BP support for debugWire:
	* src/jtag2.h: add a soft BP cache, and updateBreakpintsDW().
	* src/jtag2bp.cc: Implement updateBreakpintsDW().

2006-09-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* tools/devdescr.xsl: (New file.) Generate devdescr.cc
	entry out of the XML file.
	* src/devdescr.cc: Add entries for all debugWire AVRs,
	generated with devdescr.xsl.

2006-09-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtaggeneric.cc: Initialize is_usb properly when
	creating a new "jtag" object.

2006-09-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Mention that avrdude can turn off the
	DWEN fuse.

2006-08-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	First part of implementing debugWire support.
	* src/main.cc: Implement the debugWire framework.
	* src/jtag.h: (Ditto.)
	* src/jtag2.h: (Ditto.)
	* src/jtag2io.cc: (Ditto.)
	* src/jtag2prog.cc: (Ditto.)
	* src/jtag2rw.cc: (Ditto.)
	* src/devdescr.cc: Add an entry for the ATmega48.
	* doc/avarice.1: Document the debugWire effort.
	* configure.ac: Bump version.

2006-07-20  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Bump version.

2006-07-20  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Fix various things in the device desriptors,
	mostly affecting devices with the new EEPROM register layout:
	. use correct (according to AVR Studio) EECRaddress
	. use correct start of SRAM for ATmegaxx0/1
	. add EINDaddr for ATmegaxx0/1

2006-05-24  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Add ATmega2560/2561.

2006-05-19  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: Properly initialize the device_name member.
	* src/jtag1.h: (Ditto.)
	* src/jtag2.h: (Ditto.)
	* src/jtaggeneric.cc: (Ditto.)
	* src/main.cc: (Ditto.)

2006-04-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: fix ucAllowFullPageBitstream for AT90CAN128.

2006-04-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* doc/avarice.1: Update documentation (new devices, missing option
	documentation, bump man page date), sort options alphabetically.
	* src/main.cc: Sort options alphabetically.

2006-04-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Contributed by Michael De Nil:
	* src/jtag.h: Add support for JTAG daisy chainging;
	sourceforge.net patch tracker:
	https://sourceforge.net/tracker/index.php?func=detail&aid=1216263&group_id=39505&atid=425409
	* src/jtag1.h: (Ditto.)
	* src/jtag2.h: (Ditto.)
	* src/jtag2io.cc: (Ditto.)
	* src/jtagio.cc: (Ditto.)
	* src/main.cc: (Ditto.)

2006-04-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Add support for AT90USB1287

2006-03-27  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: fix ucAllowFullPageBitstream for
	ATmega640/1280/1281.
	* configure.ac: bump version to post-2.4

2006-01-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* Release version 2.4.

2006-01-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: bump version to 2.4
	* INSTALL-FROM-CVS: adapt instructions for the auto* tools; we
	are not very picky about the exact versions as long as they are
	reasonably recent.

2005-11-17    <dgay@intel-research.net>


	* src/jtag2io.cc (sendJtagCommand): breakpoint handling was broken
	(breakpoints detected in recv, but jtagContinue called recvFrame).
	Fix by moving it all into jtagContinue. 
	Also add extra debug output.
	* src/jtag2.h (class jtag2): see jtag2io.cc.
	* src/jtag2run.cc (jtagContinue): see jtag2io.cc.

	* scripts/ice-gdb.in: gdb's -- options can also be used with a single
	dash

	* src/utils.cc (statusOut): send debug output to stderr

2005-10-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: add ATmega640/1280/1281

2005-09-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	*  src/jtag2usb.cc: fix the libusb handling, so it will
	eventually also work with libusb-win32.

2005-08-18  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: set ucPCMaskHigh to 0 for ATmega329x/649x.

2005-08-17  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: add the ATmega329x/649x family.

2005-08-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: add check for libusb.
	* src/Makefile.am: add jtag2usb.cc.
	* src/jtag.h: add USB stuff to jtag class.
	* src/jtag2io.cc (jtag2::~jtag2()): do not prematurely return,
	use an "if" statement instead.
	* src/jtaggeneric.cc: add USB hooks (depending on configuration).
	* src/jtag2usb.cc: New file: implement USB communication.
	* doc/avarice.1: Document the USB connection method.

2005-08-15  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag2rw.cc (jtag2::jtagRead()): when word-aligning flash
	ROM requests, do also align the request base, and return the
	correct byte(s).

2005-06-20  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: add device flags.
	* src/jtag.h: add device flags, move mkI breakpoints out to jtag1.h.
	* src/jtag1.h: mkI breakpoint interface goes here.
	* src/jtag2.h: new mkII breakpoint interface.
	* src/jtag2bp.cc: ditto.
	* src/jtag2run.cc: ditto.
	* src/jtag2rw.cc: Attempt to get the "load" command working.
	* src/jtagbp.cc: remove stale "e" packet code (step-over-range-packet).
	* src/jtagrun.cc: ditto.
	* src/remote.cc: ditto.
	* scripts/gdb-avarice-script: ditto.

2005-05-31  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/jtag.h: remove friend restoreSerialPort() which doesn't
	exist at all.

2005-05-27  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	Merge the JTAG ICE mkII branch back to HEAD.
	* src/jtag2.h: (new file)
	* src/jtag2_defs.h: (new file)
	* src/jtag2bp.cc: (new file)
	* src/jtag2io.cc: (new file)
	* src/jtag2misc.cc: (new file)
	* src/jtag2prog.cc: (new file)
	* src/jtag2run.cc: (new file)
	* src/jtag2rw.cc: (new file)
	* src/crc16.c: (new file)
	* src/crc16.h: (new file)
	* Bootstrap: Export AUTO* variables.
	* configure.ac: Bump version.
	* doc/avarice.1: (Merge)
	* doc/dev_desc.txt: (Merge)
	* doc/mk2-protocol.txt: (Merge)
	* src/Makefile.am: (Merge)
	* src/devdescr.cc: (Merge)
	* src/jtag.h: (Merge)
	* src/jtag1.h: (Merge)
	* src/jtaggeneric.cc: (Merge)
	* src/jtagio.cc: (Merge)
	* src/jtagprog.cc: (Merge)
	* src/jtagrw.cc: (Merge)
	* src/main.cc: (Merge)
	* src/remote.cc: (Merge)

2005-05-24  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* src/devdescr.cc: Add IO register entries for ATmega64/128 & CAN128
	* src/ioreg.cc: Ditto.
	* src/ioreg.h: Ditto.

2005-05-13  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* configure.ac: Encapsulate the mkI protocol in its own C++ class.
	* src/Makefile.am: ditto.
	* src/devdescr.cc: ditto.
	* src/jtag.h: ditto.
	* src/jtag1.h: ditto.
	* src/jtagbp.cc: ditto.
	* src/jtaggeneric.cc: ditto.
	* src/jtagio.cc: ditto.
	* src/jtagmisc.cc: ditto.
	* src/jtagprog.cc: ditto.
	* src/jtagrun.cc: ditto.
	* src/jtagrw.cc: ditto.
	* src/main.cc: ditto.
	* src/remote.cc: ditto.

2005-04-20    <dgay@intel-research.net>

	* configure.ac: Set version to 20050420.

	* src/jtagio.cc (doJtagCommand): newly connected targets tend to
	spam JTAG_R_INFO responses, which weren't handled by the debugger
	(sympton: 'Cannot synchronise' messages). These responses are used
	to provide a channel from the target program to the debugger, but
	this is currently unused by avarice (see the IDRD register for
	details).
	
	Fix: detect JTAG_R_INFO response in sendJtagCommand. When this 
	happens, send an 'S' (get sign on) command. If we don't do this, the
	JTAG_R_INFO response seems to be repeated indefinitely...

2004-12-06  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Set version to 2.3.20041206 for cvs tracking.

2004-12-06  David Gay  <dgay@intel-research.net>

	* src/main.cc (main): resume execution on exit when not in server mode

2004-12-06  Theodore A. Roth  <troth@openavr.org>

	* Release version 2.3.

2004-12-06  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Set version to 2.3.
	* configure.ac: Add more lib checks which might be need for libbfd.

2004-11-25  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* doc/avarice.1: Add at90can128 to supported list.
	Marked as experimental.
	* src/jtag.h: Fix typo in comment describing jtag_device_desc_type.
	* src/jtagio.cc (deviceDefinitions): Add entry for at90can128.

2004-11-21  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* doc/avarice.1: Update --program option to note that erase is no
	longer implicit.
	Make NOTE bold in note for --write-fuses option.
	* src/main.cc (usage): Remove erase from --program option.

2004-11-18  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* src/jtagprog.cc (jtag_create_image):
	Replace bfd_get_section_size_before_reloc with bfd_get_section_size.
	Work around for change API in bfd.

2004-11-12  Nils Kristian Strom  <nilsst@invalid.ed.ntnu.no>

	* configure.ac (AC_INIT): Bump version.
	* src/main.cc (main): Write lock bits when all other programming
	tasks are completed.

2004-10-25  Theodore A. Roth  <troth@openavr.org>
[Contributed by Colin O'Flynn <coflynn@newae.com>]

	* configure.ac (AC_INIT): Bump version.
	* doc/mk2-protocol.txt: New file.

2004-08-08  Nils Kristian Strom  <nilsst@invalid.ed.ntnu.no>

	* src/main.cc: Move device erase in front of write fuses in case
	of device being locked.

2004-08-05  Nils Kristian Strom  <nilsst@invalid.ed.ntnu.no>

	* src/jtagio.cc: (deviceDefinitions): Fix flash and eeprom page
	sizes for mega64 and mega128. (Thanks to Ted Roth for this).
	* src/jtagprog.cc: (jtag_flash_image): Don't override device specific
	eeprom page size.

2004-08-04  Joerg Wunsch <j.gnu@uriah.heep.sax.de>

	* Bootstrap: export AUTO* variables to make automake happy.

2004-05-26  Theodore A. Roth  <troth@openavr.org>
[Contributed by Onno van Eijk <onno@gorgoz.org>]

	* configure.ac (AC_INIT): Bump version.

	* src/ioreg.cc (atmega32_io_registers): Define.
	* src/ioreg.h (atmega32_io_registers): Declare.
	* src/jtagio.cc (deviceDefinitions): Install mega32 io register defs.

2004-03-12  David Gay  <dgay@intel-research.net>

	* configure.ac: Bump version.

	* src/jtagio.cc (safewrite): write may write only part of the
	data (problem tended to show up with USB serial ports). Fix.

2004-03-08  David Gay  <dgay@intel-research.net>

	* scripts/start-avarice: add --erase option when programming

2004-02-25  Theodore A. Roth  <troth@openavr.org>

	* src/jtagprog.cc (eraseProgramMemory): Add comment noting that this is
	really a chip erase operation.
	(downloadToTarget): Don't erase the device here if programming.
	* src/main.cc (main): Never erase the device unless the user explicitly
	gives the --erase option.
	When programming without the --erase option, issue a warning about the
	change in behavior.

2004-02-06  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.

	* doc/avarice.1:
	* src/jtag.h:
	* src/jtagrw.cc:
	* src/main.cc:
	Add --read-lockbits (-l) option for reading the lockbits.

2004-01-29  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* scripts/io_gen.py: New file for helping to generate io register defs.

2004-01-28  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom <nilsst@omegav.ntnu.no>]

	* configure.ac (AC_INIT): Bump version.
	* src/ioreg.cc (atmega162_io_registers): Define.
	* src/ioreg.h (atmega162_io_registers): Declare.
	* src/jtagio.cc (deviceDefinitions): Install mega162 io register defs.

2004-01-21  Theodore A. Roth  <troth@openavr.org>
[Contributed by Bjoern Haase <bjoern.m.haase@web.de>]

	* configure.ac (AC_INIT): Bump version.
	* src/ioreg.cc: Fix spelling error.
	Add cvs Id keyword.
	(atmega169_io_registers): Define.
	* src/ioreg.h: Fix spelling error.
	Add cvs Id keyword.
	(atmega169_io_registers): Declare.
	* src/jtagio.cc (deviceDefinitions): Install mega169 io register defs.

2003-12-12  Theodore A. Roth  <troth@openavr.org>

	* Release version 2.2.

2003-12-12  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Set version to 2.2.

2003-12-08  Theodore A. Roth  <troth@openavr.org>

	* src/main.cc (usage): Fix host name and port spec to denote that
	host name, not port, is the optional part of host:port. 

2003-12-08  Theodore A. Roth  <troth@openavr.org>
[Contributed by Kolja Waschk <avus@ixo.de>]

	* configure.ac (AC_INIT): Bump version.
	* src/gnu_getopt.h: Protect against cygwin having already included 
	getop.h.
	* src/jtagio.cc (timeout_read): If either select() of read() fail and
	errno is set to EAGAIN, continue the loop instead of bombing out.
	* src/jtagrun.cc (jtagContinue): Use timeout_read() instead of read().

2003-12-06  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* avarice.spec.in (%files): Add avarice man page.
	* doc/Makefile.am (man_MANS): Add avarice.1.
	(EXTRA_DIST): Remove install.txt.
	* doc/avarice.1: New file.
	* doc/install.txt: Remove file. This file talks about Aegis being the
	build system which is no longer true since we use autoconf/automake.
	* doc/running.txt: Add note about this file being out of date.
	* doc/todo.txt: Remove some entries that have been handled.
	Add some new entries.

2003-11-16  Theodore A. Roth  <troth@openavr.org>
[Thanks to Nils Kristian Strom <nilsst@omegav.ntnu.no>]

	* configure.ac (AC_INIT): Bump version.
	* src/jtag.h (initJtagBox): Change arguments (no args needed).
	(initJtagOnChipDebugging): New prototype.
	(jtagReadFuses): Ditto.
	* src/jtagio.cc (initJtagBox): Change arguments and move attach code
	to initJtagOnChipDebugging function.
	(initJtagOnChipDebugging): New function.
	* src/jtagrw.cc (jtagReadFuses): New function.
	* src/main.cc (main): Avoid disabling lock bits and setting FUSE_OCDEN
	when we are using avarice as a standalone device programmer.
	Move --write-fuses in front of the jtag debugger initialization, to
	make it possible to start debugging with all fuses written to their
	proper settings.

2003-11-16  Theodore A. Roth  <troth@openavr.org>
[Thanks to Nils Kristian Strom <nilsst@omegav.ntnu.no>]

	* src/jtag.h (jtagDisplayFuses): Add prototype.
	* src/jtagio.cc (initJtagBox): Use jtagDisplayFuses() instead of
	calling statusOut() directly.
	* src/jtagrw.cc (jtagWriteFuses): Ditto.
	(jtagDisplayFuses): New function.

2003-11-13  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* src/jtagrw.cc (memorySpace): Use symbolic name instead of magic
	number.
	* src/remote.cc (talkToGdb): Only allow orphaned bytes when writing to
	program space. [Thanks to Brian Cuthie <brian@systemix.com> for 
	reporting this bug.]

2003-11-08  Theodore A. Roth  <troth@openavr.org>

	* src/main.cc (usage): Make the -B option info fit on a 80 column
	terminal.

2003-11-08  Theodore A. Roth  <troth@openavr.org>
[Thanks to Nils Kristian Strom <nilsst@omegav.ntnu.no>]

	* configure.ac (AC_INIT): Bump version.
	* src/jtagio.cc (initJtagBox): Inform user about the lock bits and
	fuses that actually *are* programmed, not the ones that were found in
	the device.

2003-11-01  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* src/jtag.h: Add JTAG_BITRATE_1_MHz, JTAG_BITRATE_500_KHz,
	JTAG_BITRATE_250_KHz and JTAG_BITRATE_125_KHz defs.
	(initJtagBox): Add bitrate argument.
	* src/jtagio.cc (initJtagBox): Allow passing the jtag bitrate.
	* src/main.cc: Add the -B (--jtag-bitrate) option.

2003-10-23  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* doc/dev_desc.txt: New file.
	* src/jtag.h:
	* src/jtagio.cc:
	Make the device description arrays into a structures.

2003-10-20  Theodore A. Roth  <troth@openavr.org>
[Thanks to Dean Ferreyra <dferreyra@igc.org>]

	* configure.ac (AC_INIT): Bump version.
	* src/main.cc: Fix to allow erasing the device as a single operation.

2003-09-25  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* doc/Makefile.am (EXTRA_DIST): Add the .txt files.
	* doc/README.cygwin: New file, from Eric Weddington.

2003-09-18  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* avarice.spec.in: Add man pages.

2003-09-18  Theodore A. Roth  <troth@openavr.org>
[Thanks to Amedee Louis Beaudoin <deoxy@u.washington.edu>]

	* src/jtagrw.cc (jtagWriteFuses): Enter programming mode before writing
	and exit program mode after reading.
	(jtagWriteLockBits): Ditto.

2003-08-25  David Gay  <dgay@intel-research.net>

	* configure.ac: bump version
	* src/jtagprog.cc: work around cygwin gcc (3.2.3) bug with
	large stack allocated locals by making them static

2003-08-21  David Gay  <dgay@intel-research.net>

	* doc/ice-insight.1: new file, ice-insight man page
	* doc/ice-gdb.1: new file, ice-gdb man page
	* doc/Makefile.am: new file
	* Makefile.am (SUBDIRS): make doc subdir
	* configure.ac: Bump revision, add doc Makefile

2003-08-20  Theodore A. Roth  <troth@openavr.org>

	* src/jtagrun.cc (jtagContinue): Add debug output to show what the 
	jtag box returned, especially the break status register.

2003-08-19  Theodore A. Roth  <troth@openavr.org>

	* configure.ac (AC_INIT): Bump version.
	* src/jtagprog.cc (get_section_addr): Fix to allow programming of upper
	64k of flash.

2003-08-18  David Gay  <dgay@intel-research.net>

	* src/main.cc (main): Add missing --file option for getopt
	  [Thanks to Mike Hudson <pontifex@isys.ca>]

2003-08-15  Theodore A. Roth  <troth@openavr.org>

	* Makefile.am (dist-hook): New rule.
	* configure.ac (AC_INIT): Bump version.
	(AC_CONFIG_FILES): Add avarice.spec.
	* avarice.spec.in: New file.

2003-08-15  Theodore A. Roth  <troth@openavr.org>
[Thanks to Nils Kristian Strom <nilsst@omegav.ntnu.no>]

	* src/main.cc (long_opts): Fix short opts to match usage output.

2003-08-08  Theodore A. Roth  <troth@openavr.org>
[Thanks to James Harris  <James.Harris@codan.com.au>]

	* src/gnu_getopt.h: Define HAVE_DECL_GETOPT to fix declaration clash.

2003-08-06  David Gay  <dgay@intel-research.net>

	* src/main.cc (main): actually implement --version
	* configure.ac: Bump version.

2003-08-05  David Gay  <dgay@intel-research.net>

	* scripts/start-avarice: use new host:portname syntax

2003-08-05  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump version.
	* src/Makefile.am (avarice_SOURCES): Add gnu_getopt* files.
	* src/avarice.h: Delete DEFAULT_PORT.
	* src/gnu_getopt.c: New file.
	* src/gnu_getopt.h: New file.
	* src/gnu_getopt1.c: New file.
	* src/main.cc: Use gnu getop_long() to parse argv.
	Clean up usage() output to be more compact.
	Allow operations (program, erase, verify, write-fuses, etc) to be 
	performed before going into gdb server mode.
	Change "[[hostname] port]" options into a single "[[host]:port]"
	option where ":port" causes avarice to enter server mode.
	All options now have short and long equivalents.

2003-08-04  Theodore A. Roth  <troth@openavr.org>

	* src/main.cc: Revert program flag to default to false.
	Revert setting program flag to false if --verify is given.

2003-07-31  David Gay  <dgay@intel-research.net>

	* src/main.cc (main): when no gdb interaction: don't perform
	extraneous enableProgramming/disableProgramming
	when gdb interaction: program if a file specified
	* scripts/gdb-avarice-script: set hardware watch/break limits
	* scripts/ice-gdb.in: --ignore-intr should not capture,
	--external flag
	* scripts/start-avarice: no need for avr-objcopy

2003-07-29  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump version.
	Search for library needed for inet_aton().

2003-07-25  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump Version
	* src/jtagio.cc: Double all of the vectors_end initializers.

2003-07-24  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump version.
	* src/jtagprog.cc (initImage): Fix off by one in for loop.
	(jtag_create_image): Clean up for loop to use common idiom.
	(jtag_flash_image): Clean up for loop to use common idiom.
	When verifying, verify all bytes instead of bombing out at first error.
	* src/main.cc (usage): Add info for verify option.

2003-07-24  Theodore A. Roth  <troth@openavr.org>

	* src/jtagprog.cc (jtag_create_image): Fix off by one error.

2003-07-10  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom  <nilsst@omegav.ntnu.no>]

	* src/jtag.h:
	* src/jtagprog.cc:
	* src/main.cc:
	Add verification of program and data after downloading to device.

2003-07-10  Theodore A. Roth  <troth@openavr.org>

	* doc/todo.txt: Update todo list.

2003-07-10  Theodore A. Roth  <troth@openavr.org>
[Contributed by Joerg Wunsch <joerg_wunsch@uriah.heep.sax.de>]

	* configure.ac: Bump version.
	* src/avarice.h: Define DEFAULT_PORT.
	* src/main.cc: Have host default to listening on any interface and 
	port default to DEFAULT_PORT (4242).

2003-07-07  David Gay  <dgay@intel-research.net>

	* src/jtag.h: Add vectors_end to jtag_device_def_type.
	* src/jtagio.cc: Add vectors_end values to device initializers.
	* src/remote.cc: Use vectors_end when ignoring interrupts.

2003-07-07  David Gay  <dgay@intel-research.net>

	* src/jtagio.cc: Better fix, comment for device id problem.

2003-07-07  David Gay  <dgay@intel-research.net>

	* src/jtagio.cc: Fix problem with --capture and reading device id.

2003-07-03  David Gay  <dgay@intel-research.net>

	* src/jtagio.cc: Check pointer before passing to strcmp().
	Update comment for JTAG bitrate.
	* src/jtagprog.cc: Fix a spelling error.
	Move "." status out of jtagWrite back to download.
	* src/jtagrw.cc: Move "." status out of jtagWrite back to download.
	* src/main.cc: Reset remote target after download (debugging won't work
	without that reset).
	* src/remote.cc: Extend interrupt ignore stuff to singlestep, makes it
	much more useable in gdb. Still need to find extent of interrupt table
	based on device id.

2003-07-02  Theodore A. Roth  <troth@openavr.org>
[Contributed by Jake McGuire <jake@boom.net>]

	* src/jtagio.cc: Add support for mega64.

2003-07-02  Theodore A. Roth  <troth@openavr.org>
[Contributed by Joerg Wunsch <joerg_wunsch@uriah.heep.sax.de>]

	* configure.ac: Bump version.
	* src/jtagprog.cc: SEC_ARCH_BIT_0 and SEC_THREAD_LOCAL are not
	available on some older bfd libraries.
	* src/main.cc: BSD always requires the inclusion of <sys/types.h>
	before <sys/socket.h>.
	(initSocketAddress): struct sockaddr_in in 4.4BSD contains some padding
	at the end in a struct field named sin_zero which needs zero'ed out.

2003-06-13  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump version.
	* src/jtagio.cc: Set JTAG_P_CLOCK param to 0xff instead of 0xfd to
	speed things up a little bit.
	* src/remote.cc: Remove a debug output statement.

2003-06-12  Theodore A. Roth  <troth@openavr.org>

	* doc/todo.txt: Remove some items that have been fixed or are now
	working.

2003-06-12  Theodore A. Roth  <troth@openavr.org>

	* src/jtagrw.cc (jtagWrite): Print debug message if addr or length is
	odd.
	* src/remote.cc (reportStatusExtended): New function for replying with
	a 'T' packet instead of an 'S' packet.
	Use new function whenever a breakpoint is hit from a step or continue
	command from gdb.

2003-06-12  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump version.
	* src/remote.cc: Remove call to interruptProgram() when handling a 'g'
	packet. This was accidently committed and should not have been since
	it causes the jtagice box to corrupt the program counter. Not good.

2003-06-11  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Bump version.
	* src/jtagio.cc: Remove check failure for jtag ice HW version.
	* src/remote.cc: Fix handling the 'M' command from GDB to allow for
	odd addresses and lengths.

2003-06-05  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Check for intl library since linking to bfd may
	require it (this affects cygwin). [Thanks Colid O'Flynn for reporting
	this.]

2003-05-04  Theodore A. Roth  <troth@openavr.org>
[Contributed by Alan Willis <willisa@erols.com>.]

	* src/jtagprog.cc: Speed up programming the flash by skipping pages
	that are all ones.

2003-05-04  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom  <nilsst@omegav.ntnu.no>]

	* src/main.cc: Allow all programmer-operations (erase device,
	write memory, write fuses, write lockbits) in one pass.

2003-05-04  Theodore A. Roth  <troth@openavr.org>

	* configure.ac: Check for libbfd and libiberty, complain if either is
	missing.
	Bump version.
	* src/jtagio.cc: When opening the jtagice device, give a more helpful 
	failure message.

2003-05-04  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom  <nilsst@omegav.ntnu.no>]

	* src/jtag.h:
	* src/jtagprog.cc:
	* src/jtagrw.cc:
	Use the bfd library for handling multiple input file formats.

2003-05-01  Theodore A. Roth  <troth@openavr.org>

	* src/jtagrw.cc: Fix byte order problem when specifying fuses bytes 
	on the command line.

2003-04-20  Theodore A. Roth  <troth@openavr.org>

	* AUTHORS: Fix a typo.
	* INSTALL-FROM-CVS: Add detailed description about using the proper
	versions of autoconf and automake.
	* configure.ac: Ran autoscan to generate this file to check for more
	potential portability problem points.
	Use autoconf-2.57 and automake-1.7.3 (trying make things work right
	with any versions is a royal PITA).
	Have autoheader generate src/autoconf.hin instead of autoconf.h.in so
	8.3 systems don't puke.
	* configure.in: Removed (replaced by configure.ac).
	* .cvsignore: Ignore all diff and patch files.
	Ignore all autom4te*.cache dirs.
	* src/.cvsignore: Ignore TAGS and tags files.
	Ignore autoconf.hin instead of autoconf.h.in.

2003-04-03  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom <nilsst@omegav.ntnu.no>].

	* configure.in: Bump version.
	* src/jtag.h:
	* src/jtagrw.cc:
	* src/main.cc:
	Add support for writing the lockbits from the command line.

2003-04-02  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom <nilsst@omegav.ntnu.no>].

	* src/jtag.h:
	* src/jtagrw.cc:
	* src/main.cc:
	Add support for writing fuses from the command line.

2003-04-02  Theodore A. Roth  <troth@openavr.org>
[Contributed by Nils Kristian Strom <nilsst@omegav.ntnu.no>].

	* configure.in: Bump version.
	* src/main.cc: Move #include <unistd.h> to fix a build failure on
	FreeBSD.

2003-04-01  Theodore A. Roth  <troth@openavr.org>
[Contributed by Jake McGuire <jake@boom.net>]

	* src/main.cc: Ports should be printed as unsigned values instead of
	signed.

2003-04-01  Theodore A. Roth  <troth@openavr.org>

	* configure.in: Add check for socklen_t type.

2003-04-01  Theodore A. Roth  <troth@openavr.org>
[Contributed by Jake McGuire <jake@boom.net>]

	* configure.in: Bump version.
	* src/jtagio.cc: Don't set serial speed by changing termios structure
	since this breaks on OS X. Use cfsetospeed() and cfsetispeed().

2003-03-27  Theodore A. Roth  <troth@openavr.org>

	* configure.in: Add checks for libsocket and libnsl.

2003-03-27  Theodore A. Roth  <troth@openavr.org>
[Contributed by James Harris <James.Harris@codan.com.au>]

	* src/jtag.h: Lengthen JTAG_RESPONSE_TIMEOUT so slower systems have
	a fair chance to respond.
	* src/remote.cc: Passing an int to read(2) is not bigendian friendly,
	so pass an unsigned char instead.

2003-03-27  Theodore A. Roth  <troth@openavr.org>

	* src/remote.cc: Add handling of 'C' packet. Using 'sig SIGHUP' command
	from gdb will cause avarice to reset the user program.

2003-03-27  Theodore A. Roth  <troth@openavr.org>

	* Bootstrap: Remove need to run autotools in src.
	* configure.in: Remove need for src/configure.in.
	* src/configure.in: Remove file.

2003-03-27  Theodore A. Roth  <troth@openavr.org>
[Contributed by James Harris <James.Harris@codan.com.au>]

	* src/Makefile.am (avarice_SOURCES): Add ioreg.cc and ioreg.h.
	* src/ioreg.cc: New file.
	* src/ioreg.h: New file.
	* src/jtag.h: Add io_reg_defs field to jtag_device_def_type struct.
	* src/jtagio.cc: Add io_reg_defs field initializers.
	* src/remote.cc: Add 'q' packet handling of "Ravr.io_reg" queries.

2003-03-27  Theodore A. Roth  <troth@openavr.org>

	* src/remote.cc: Break out of 'g' packet case if an error occurs.

2003-03-27  Theodore A. Roth  <troth@openavr.org>
[Contributed by James Harris <James.Harris@codan.com.au>]

	* src/remote.cc: When handling a 'g' packet, only read the 32 GPR's,
	SPL, SPH, and SREG. Reading some other io registers can have side
	effects.

2003-03-27  Theodore A. Roth  <troth@openavr.org>
[Contributed by James Harris <James.Harris@codan.com.au>]

	* src/jtag.h: Remove unused deviceType enum.
	* src/jtagprog.cc: Tell the jtagbox the device dependant flash and
	eeprom pagesizes based on device definition info.

2003-03-26  Theodore A. Roth  <troth@openavr.org>
[Contributed by Jeff Rose <rosejn@Colorado.EDU>]

	* src/jtagio.cc (getJtagResponse): Use JTAG_RESPONSE_TIMEOUT instead
	of JTAG_COMM_TIMEOUT when reading the response from the jtag box.
	* src/main.cc: Don't require hostname and portnumber options if they
	aren't needed.

2003-03-25  Theodore A. Roth  <troth@openavr.org>
[Contributed by James Harris <James.Harris@codan.com.au>]

	* src/jtag.h: Add jtag_device_def_type structure.
	Add various missing jtag values.
	* src/jtagio.cc: Add auto detection and configuration of target device.
	Always report jtag box hw and sw versions.
	* src/main.cc: Add --part command line option.

2003-03-17  Theodore A. Roth  <troth@openavr.org>

	* Bootstrap: Add "-a -c" to second call to automake so depcomp will be
	installed if it is missing.

2003-02-28  Theodore A. Roth  <troth@openavr.org>

	* AUTHORS: New file.
	* Bootstrap: Allow user to specify which versions of the auto tools
	to use by setting environment variables.
	* ChangeLog: New file.

